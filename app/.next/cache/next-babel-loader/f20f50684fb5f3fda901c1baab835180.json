{"ast":null,"code":"import _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/home/truongduchuy910/apps/tuvi/app/utils/MessengerChat.js\";\nvar __jsx = React.createElement;\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n/**\n * Utils\n */\n\nvar removeElementByIds = function removeElementByIds(ids) {\n  ids.forEach(function (id) {\n    var element = document.getElementById(id);\n\n    if (element && element.parentNode) {\n      element.parentNode.removeChild(element);\n    }\n  });\n};\n/**\n * Messenger Chat Plugin\n */\n\n\nvar MessengerChat =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(MessengerChat, _Component);\n\n  function MessengerChat(props) {\n    var _this;\n\n    _classCallCheck(this, MessengerChat);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(MessengerChat).call(this, props));\n    _this.setFbAsyncInit = _this.setFbAsyncInit.bind(_assertThisInitialized(_this));\n    _this.reloadSDKAsynchronously = _this.reloadSDKAsynchronously.bind(_assertThisInitialized(_this));\n    _this.loadSDKAsynchronously = _this.loadSDKAsynchronously.bind(_assertThisInitialized(_this));\n    _this.createMarkup = _this.createMarkup.bind(_assertThisInitialized(_this));\n    _this.controlPlugin = _this.controlPlugin.bind(_assertThisInitialized(_this));\n    _this.subscribeEvents = _this.subscribeEvents.bind(_assertThisInitialized(_this));\n    _this.removeFacebookSDK = _this.removeFacebookSDK.bind(_assertThisInitialized(_this));\n    _this.state = {\n      fbLoaded: false,\n      shouldShowDialog: undefined\n    };\n    return _this;\n  }\n\n  _createClass(MessengerChat, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.setFbAsyncInit();\n      this.reloadSDKAsynchronously();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (prevProps.pageId !== this.props.pageId || // prevProps.appId !== this.props.appId ||\n      prevProps.shouldShowDialog !== this.props.shouldShowDialog || prevProps.htmlRef !== this.props.htmlRef || prevProps.minimized !== this.props.minimized || prevProps.themeColor !== this.props.themeColor || prevProps.loggedInGreeting !== this.props.loggedInGreeting || prevProps.loggedOutGreeting !== this.props.loggedOutGreeting || prevProps.greetingDialogDisplay !== this.props.greetingDialogDisplay || prevProps.greetingDialogDelay !== this.props.greetingDialogDelay || prevProps.autoLogAppEvents !== this.props.autoLogAppEvents || prevProps.xfbml !== this.props.xfbml || prevProps.version !== this.props.version || prevProps.language !== this.props.language) {\n        this.setFbAsyncInit();\n        this.reloadSDKAsynchronously();\n      }\n    }\n  }, {\n    key: \"setFbAsyncInit\",\n    value: function setFbAsyncInit() {\n      var _this2 = this;\n\n      var _this$props = this.props,\n          autoLogAppEvents = _this$props.autoLogAppEvents,\n          xfbml = _this$props.xfbml,\n          version = _this$props.version;\n\n      window.fbAsyncInit = function () {\n        window.FB.init({\n          // appId,\n          autoLogAppEvents: autoLogAppEvents,\n          xfbml: xfbml,\n          version: \"v\".concat(version)\n        });\n\n        _this2.setState({\n          fbLoaded: true\n        });\n      };\n    }\n  }, {\n    key: \"loadSDKAsynchronously\",\n    value: function loadSDKAsynchronously() {\n      // const { language } = this.props\n\n      /* eslint-disable */\n      (function (d, s, id) {\n        var js,\n            fjs = d.getElementsByTagName(s)[0];\n\n        if (d.getElementById(id)) {\n          return;\n        }\n\n        js = d.createElement(s);\n        js.id = id;\n        js.src = \"https://connect.facebook.net/vi_VN/sdk/xfbml.customerchat.js\";\n        fjs.parentNode.insertBefore(js, fjs);\n      })(document, \"script\", \"facebook-jssdk\");\n      /* eslint-enable */\n\n    }\n  }, {\n    key: \"removeFacebookSDK\",\n    value: function removeFacebookSDK() {\n      removeElementByIds([\"facebook-jssdk\", \"fb-root\"]);\n      delete window.FB;\n    }\n  }, {\n    key: \"reloadSDKAsynchronously\",\n    value: function reloadSDKAsynchronously() {\n      this.removeFacebookSDK();\n      this.loadSDKAsynchronously();\n    }\n  }, {\n    key: \"controlPlugin\",\n    value: function controlPlugin() {\n      var shouldShowDialog = this.props.shouldShowDialog;\n\n      if (shouldShowDialog) {\n        window.FB.CustomerChat.showDialog();\n      } else {\n        window.FB.CustomerChat.hideDialog();\n      }\n    }\n  }, {\n    key: \"subscribeEvents\",\n    value: function subscribeEvents() {\n      var _this$props2 = this.props,\n          onCustomerChatDialogShow = _this$props2.onCustomerChatDialogShow,\n          onCustomerChatDialogHide = _this$props2.onCustomerChatDialogHide;\n\n      if (onCustomerChatDialogShow) {\n        window.FB.Event.subscribe(\"customerchat.dialogShow\", onCustomerChatDialogShow);\n      }\n\n      if (onCustomerChatDialogHide) {\n        window.FB.Event.subscribe(\"customerchat.dialogHide\", onCustomerChatDialogHide);\n      }\n    }\n  }, {\n    key: \"createMarkup\",\n    value: function createMarkup() {\n      var _this$props3 = this.props,\n          pageId = _this$props3.pageId,\n          htmlRef = _this$props3.htmlRef,\n          minimized = _this$props3.minimized,\n          themeColor = _this$props3.themeColor,\n          loggedInGreeting = _this$props3.loggedInGreeting,\n          loggedOutGreeting = _this$props3.loggedOutGreeting,\n          greetingDialogDisplay = _this$props3.greetingDialogDisplay,\n          greetingDialogDelay = _this$props3.greetingDialogDelay;\n      var refAttribute = htmlRef !== undefined ? \"ref=\\\"\".concat(htmlRef, \"\\\"\") : \"\";\n      var minimizedAttribute = minimized !== undefined ? \"minimized=\\\"\".concat(minimized, \"\\\"\") : \"\";\n      var themeColorAttribute = themeColor !== undefined ? \"theme_color=\\\"\".concat(themeColor, \"\\\"\") : \"\";\n      var loggedInGreetingAttribute = loggedInGreeting !== undefined ? \"logged_in_greeting=\\\"\".concat(loggedInGreeting, \"\\\"\") : \"\";\n      var loggedOutGreetingAttribute = loggedOutGreeting !== undefined ? \"logged_out_greeting=\\\"\".concat(loggedOutGreeting, \"\\\"\") : \"\";\n      var greetingDialogDisplayAttribute = greetingDialogDisplay !== undefined ? \"greeting_dialog_display=\\\"\".concat(greetingDialogDisplay, \"\\\"\") : \"\";\n      var greetingDialogDelayAttribute = greetingDialogDelay !== undefined ? \"greeting_dialog_delay=\\\"\".concat(greetingDialogDelay, \"\\\"\") : \"\";\n      return {\n        __html: \"<div\\n             class=\\\"fb-customerchat\\\"\\n             page_id=\\\"\".concat(pageId, \"\\\"\\n             \").concat(refAttribute, \"\\n             \").concat(minimizedAttribute, \"\\n             \").concat(themeColorAttribute, \"\\n             \").concat(loggedInGreetingAttribute, \"\\n             \").concat(loggedOutGreetingAttribute, \"\\n             \").concat(greetingDialogDisplayAttribute, \"\\n             \").concat(greetingDialogDelayAttribute, \"\\n           ></div>\")\n      };\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$state = this.state,\n          fbLoaded = _this$state.fbLoaded,\n          shouldShowDialog = _this$state.shouldShowDialog;\n\n      if (fbLoaded && shouldShowDialog !== this.props.shouldShowDialog) {\n        document.addEventListener(\"DOMNodeInserted\", function (event) {\n          var element = event.target;\n\n          if (element.className && typeof element.className === \"string\" && element.className.includes(\"fb_dialog\")) {\n            _this3.controlPlugin();\n          }\n        }, false);\n        this.subscribeEvents();\n      } // Add a random key to rerender. Reference:\n      // https://stackoverflow.com/questions/30242530/dangerouslysetinnerhtml-doesnt-update-during-render\n\n\n      return __jsx(\"div\", {\n        key: Date(),\n        dangerouslySetInnerHTML: this.createMarkup(),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 246\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return MessengerChat;\n}(Component);\n\n_defineProperty(MessengerChat, \"propTypes\", {\n  pageId: PropTypes.string.isRequired,\n  // appId:                    PropTypes.string.isRequired,\n  shouldShowDialog: PropTypes.bool,\n  htmlRef: PropTypes.string,\n  minimized: PropTypes.bool,\n  themeColor: PropTypes.string,\n  loggedInGreeting: PropTypes.string,\n  loggedOutGreeting: PropTypes.string,\n  greetingDialogDisplay: PropTypes.oneOf([\"show\", \"hide\", \"fade\"]),\n  greetingDialogDelay: PropTypes.number,\n  autoLogAppEvents: PropTypes.bool,\n  xfbml: PropTypes.bool,\n  version: PropTypes.string,\n  // language:                 PropTypes.string,\n  onCustomerChatDialogShow: PropTypes.func,\n  onCustomerChatDialogHide: PropTypes.func\n});\n\n_defineProperty(MessengerChat, \"defaultProps\", {\n  shouldShowDialog: false,\n  htmlRef: undefined,\n  minimized: undefined,\n  themeColor: undefined,\n  loggedInGreeting: undefined,\n  loggedOutGreeting: undefined,\n  greetingDialogDisplay: undefined,\n  greetingDialogDelay: undefined,\n  autoLogAppEvents: true,\n  xfbml: true,\n  version: \"6.0\",\n  onCustomerChatDialogShow: undefined,\n  onCustomerChatDialogHide: undefined\n});\n\nexport default MessengerChat;","map":{"version":3,"sources":["/home/truongduchuy910/apps/tuvi/app/utils/MessengerChat.js"],"names":["React","Component","PropTypes","removeElementByIds","ids","forEach","id","element","document","getElementById","parentNode","removeChild","MessengerChat","props","setFbAsyncInit","bind","reloadSDKAsynchronously","loadSDKAsynchronously","createMarkup","controlPlugin","subscribeEvents","removeFacebookSDK","state","fbLoaded","shouldShowDialog","undefined","prevProps","pageId","htmlRef","minimized","themeColor","loggedInGreeting","loggedOutGreeting","greetingDialogDisplay","greetingDialogDelay","autoLogAppEvents","xfbml","version","language","window","fbAsyncInit","FB","init","setState","d","s","js","fjs","getElementsByTagName","createElement","src","insertBefore","CustomerChat","showDialog","hideDialog","onCustomerChatDialogShow","onCustomerChatDialogHide","Event","subscribe","refAttribute","minimizedAttribute","themeColorAttribute","loggedInGreetingAttribute","loggedOutGreetingAttribute","greetingDialogDisplayAttribute","greetingDialogDelayAttribute","__html","addEventListener","event","target","className","includes","Date","string","isRequired","bool","oneOf","number","func"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\n/**\n * Utils\n */\nconst removeElementByIds = ids => {\n  ids.forEach(id => {\n    const element = document.getElementById(id);\n    if (element && element.parentNode) {\n      element.parentNode.removeChild(element);\n    }\n  });\n};\n\n/**\n * Messenger Chat Plugin\n */\nclass MessengerChat extends Component {\n  static propTypes = {\n    pageId: PropTypes.string.isRequired,\n    // appId:                    PropTypes.string.isRequired,\n    shouldShowDialog: PropTypes.bool,\n    htmlRef: PropTypes.string,\n    minimized: PropTypes.bool,\n    themeColor: PropTypes.string,\n    loggedInGreeting: PropTypes.string,\n    loggedOutGreeting: PropTypes.string,\n    greetingDialogDisplay: PropTypes.oneOf([\"show\", \"hide\", \"fade\"]),\n    greetingDialogDelay: PropTypes.number,\n    autoLogAppEvents: PropTypes.bool,\n    xfbml: PropTypes.bool,\n    version: PropTypes.string,\n    // language:                 PropTypes.string,\n    onCustomerChatDialogShow: PropTypes.func,\n    onCustomerChatDialogHide: PropTypes.func\n  };\n\n  static defaultProps = {\n    shouldShowDialog: false,\n    htmlRef: undefined,\n    minimized: undefined,\n    themeColor: undefined,\n    loggedInGreeting: undefined,\n    loggedOutGreeting: undefined,\n    greetingDialogDisplay: undefined,\n    greetingDialogDelay: undefined,\n    autoLogAppEvents: true,\n    xfbml: true,\n    version: \"6.0\",\n    onCustomerChatDialogShow: undefined,\n    onCustomerChatDialogHide: undefined\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.setFbAsyncInit = this.setFbAsyncInit.bind(this);\n    this.reloadSDKAsynchronously = this.reloadSDKAsynchronously.bind(this);\n    this.loadSDKAsynchronously = this.loadSDKAsynchronously.bind(this);\n    this.createMarkup = this.createMarkup.bind(this);\n    this.controlPlugin = this.controlPlugin.bind(this);\n    this.subscribeEvents = this.subscribeEvents.bind(this);\n    this.removeFacebookSDK = this.removeFacebookSDK.bind(this);\n\n    this.state = {\n      fbLoaded: false,\n      shouldShowDialog: undefined\n    };\n  }\n\n  componentDidMount() {\n    this.setFbAsyncInit();\n    this.reloadSDKAsynchronously();\n  }\n\n  componentDidUpdate(prevProps) {\n    if (\n      prevProps.pageId !== this.props.pageId ||\n      // prevProps.appId !== this.props.appId ||\n      prevProps.shouldShowDialog !== this.props.shouldShowDialog ||\n      prevProps.htmlRef !== this.props.htmlRef ||\n      prevProps.minimized !== this.props.minimized ||\n      prevProps.themeColor !== this.props.themeColor ||\n      prevProps.loggedInGreeting !== this.props.loggedInGreeting ||\n      prevProps.loggedOutGreeting !== this.props.loggedOutGreeting ||\n      prevProps.greetingDialogDisplay !== this.props.greetingDialogDisplay ||\n      prevProps.greetingDialogDelay !== this.props.greetingDialogDelay ||\n      prevProps.autoLogAppEvents !== this.props.autoLogAppEvents ||\n      prevProps.xfbml !== this.props.xfbml ||\n      prevProps.version !== this.props.version ||\n      prevProps.language !== this.props.language\n    ) {\n      this.setFbAsyncInit();\n      this.reloadSDKAsynchronously();\n    }\n  }\n\n  setFbAsyncInit() {\n    const { autoLogAppEvents, xfbml, version } = this.props;\n\n    window.fbAsyncInit = () => {\n      window.FB.init({\n        // appId,\n        autoLogAppEvents,\n        xfbml,\n        version: `v${version}`\n      });\n\n      this.setState({ fbLoaded: true });\n    };\n  }\n\n  loadSDKAsynchronously() {\n    // const { language } = this.props\n    /* eslint-disable */\n    (function(d, s, id) {\n      var js,\n        fjs = d.getElementsByTagName(s)[0];\n      if (d.getElementById(id)) {\n        return;\n      }\n      js = d.createElement(s);\n      js.id = id;\n      js.src = `https://connect.facebook.net/vi_VN/sdk/xfbml.customerchat.js`;\n      fjs.parentNode.insertBefore(js, fjs);\n    })(document, \"script\", \"facebook-jssdk\");\n    /* eslint-enable */\n  }\n\n  removeFacebookSDK() {\n    removeElementByIds([\"facebook-jssdk\", \"fb-root\"]);\n    delete window.FB;\n  }\n\n  reloadSDKAsynchronously() {\n    this.removeFacebookSDK();\n    this.loadSDKAsynchronously();\n  }\n\n  controlPlugin() {\n    const { shouldShowDialog } = this.props;\n\n    if (shouldShowDialog) {\n      window.FB.CustomerChat.showDialog();\n    } else {\n      window.FB.CustomerChat.hideDialog();\n    }\n  }\n\n  subscribeEvents() {\n    const { onCustomerChatDialogShow, onCustomerChatDialogHide } = this.props;\n\n    if (onCustomerChatDialogShow) {\n      window.FB.Event.subscribe(\n        \"customerchat.dialogShow\",\n        onCustomerChatDialogShow\n      );\n    }\n\n    if (onCustomerChatDialogHide) {\n      window.FB.Event.subscribe(\n        \"customerchat.dialogHide\",\n        onCustomerChatDialogHide\n      );\n    }\n  }\n\n  createMarkup() {\n    const {\n      pageId,\n      htmlRef,\n      minimized,\n      themeColor,\n      loggedInGreeting,\n      loggedOutGreeting,\n      greetingDialogDisplay,\n      greetingDialogDelay\n    } = this.props;\n\n    const refAttribute = htmlRef !== undefined ? `ref=\"${htmlRef}\"` : \"\";\n\n    const minimizedAttribute =\n      minimized !== undefined ? `minimized=\"${minimized}\"` : \"\";\n\n    const themeColorAttribute =\n      themeColor !== undefined ? `theme_color=\"${themeColor}\"` : \"\";\n\n    const loggedInGreetingAttribute =\n      loggedInGreeting !== undefined\n        ? `logged_in_greeting=\"${loggedInGreeting}\"`\n        : \"\";\n\n    const loggedOutGreetingAttribute =\n      loggedOutGreeting !== undefined\n        ? `logged_out_greeting=\"${loggedOutGreeting}\"`\n        : \"\";\n\n    const greetingDialogDisplayAttribute =\n      greetingDialogDisplay !== undefined\n        ? `greeting_dialog_display=\"${greetingDialogDisplay}\"`\n        : \"\";\n\n    const greetingDialogDelayAttribute =\n      greetingDialogDelay !== undefined\n        ? `greeting_dialog_delay=\"${greetingDialogDelay}\"`\n        : \"\";\n\n    return {\n      __html: `<div\n             class=\"fb-customerchat\"\n             page_id=\"${pageId}\"\n             ${refAttribute}\n             ${minimizedAttribute}\n             ${themeColorAttribute}\n             ${loggedInGreetingAttribute}\n             ${loggedOutGreetingAttribute}\n             ${greetingDialogDisplayAttribute}\n             ${greetingDialogDelayAttribute}\n           ></div>`\n    };\n  }\n\n  render() {\n    const { fbLoaded, shouldShowDialog } = this.state;\n\n    if (fbLoaded && shouldShowDialog !== this.props.shouldShowDialog) {\n      document.addEventListener(\n        \"DOMNodeInserted\",\n        event => {\n          const element = event.target;\n          if (\n            element.className &&\n            typeof element.className === \"string\" &&\n            element.className.includes(\"fb_dialog\")\n          ) {\n            this.controlPlugin();\n          }\n        },\n        false\n      );\n      this.subscribeEvents();\n    }\n    // Add a random key to rerender. Reference:\n    // https://stackoverflow.com/questions/30242530/dangerouslysetinnerhtml-doesnt-update-during-render\n    return <div key={Date()} dangerouslySetInnerHTML={this.createMarkup()} />;\n  }\n}\n\nexport default MessengerChat;\n"]},"metadata":{},"sourceType":"module"}