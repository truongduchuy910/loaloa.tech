{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{\"2Nex\":function(e,t,n){\"use strict\";n.d(t,\"a\",(function(){return r}));var a=n(\"mXGw\");function r(e,t){return a.isValidElement(e)&&-1!==t.indexOf(e.type.muiName)}},\"3pQS\":function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push([\"/adminChat\",function(){return n(\"RGu7\")}])},\"60we\":function(e,t,n){\"use strict\";var a=n(\"UrUy\"),r=n.n(a),o=n(\"mXGw\"),i=n.n(o),s=n(\"R82R\"),c=n(\"bJWG\"),l=n(\"q+kb\"),d=n(\"Fcif\"),u=n(\"dV/x\"),m=(n(\"W0B4\"),n(\"PDtE\")),p=n(\"gbh0\"),b=n(\"Rx6o\"),f=o.forwardRef((function(e,t){var n=e.absolute,a=void 0!==n&&n,r=e.classes,i=e.className,s=e.component,c=void 0===s?\"hr\":s,l=e.flexItem,p=void 0!==l&&l,b=e.light,f=void 0!==b&&b,v=e.orientation,g=void 0===v?\"horizontal\":v,h=e.role,y=void 0===h?\"hr\"!==c?\"separator\":void 0:h,x=e.variant,O=void 0===x?\"fullWidth\":x,j=Object(u.a)(e,[\"absolute\",\"classes\",\"className\",\"component\",\"flexItem\",\"light\",\"orientation\",\"role\",\"variant\"]);return o.createElement(c,Object(d.a)({className:Object(m.a)(r.root,i,\"fullWidth\"!==O&&r[O],a&&r.absolute,p&&r.flexItem,f&&r.light,\"vertical\"===g&&r.vertical),role:y,ref:t},j))})),v=Object(p.a)((function(e){return{root:{height:1,margin:0,border:\"none\",flexShrink:0,backgroundColor:e.palette.divider},absolute:{position:\"absolute\",bottom:0,left:0,width:\"100%\"},inset:{marginLeft:72},light:{backgroundColor:Object(b.c)(e.palette.divider,.08)},middle:{marginLeft:e.spacing(2),marginRight:e.spacing(2)},vertical:{height:\"100%\",width:1},flexItem:{alignSelf:\"stretch\",height:\"auto\"}}}),{name:\"MuiDivider\"})(f),g=n(\"oQEK\"),h=n(\"eiJB\"),y=n.n(h),x=n(\"KoC1\");n.d(t,\"a\",(function(){return C}));var O=i.a.createElement,j={createMessage:\"mutation($text: String, $conversation: ConversationWhereUniqueInput) {\\n    createMessage(\\n      data: { text: $text, conversation: { connect: $conversation } }\\n    ) {\\n      id\\n    }\\n  }\"},w=Object(s.a)((function(e){return{root:{padding:\"1px 2px\",display:\"flex\",alignItems:\"center\",width:\"100%\",borderRadius:8},input:{marginLeft:e.spacing(1),flex:1},iconButton:{padding:8},divider:{height:21,margin:3}}}));function C(e){var t=e.conversation,n=w(),a=Object(o.useState)(),i=a[0],s=a[1],d=Object(o.useState)();d[0],d[1];function u(){var e,n;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!i){a.next=7;break}return a.next=3,r.a.awrap(Object(x.a)({body:{query:j.createMessage,variables:{text:i,conversation:t}}}));case 3:e=a.sent,n=e.data,console.log(n),s(\"\");case 7:case\"end\":return a.stop()}}))}return O(c.a,{className:n.root,onKeyPress:function(e){return r.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(\"Enter\"!=e.key){t.next=3;break}return t.next=3,r.a.awrap(u());case 3:case\"end\":return t.stop()}}))}},O(l.a,{className:n.input,placeholder:\"Nh\\u1eadp tin nh\\u1eafn\",onChange:function(e){return s(e.target.value)},inputProps:{\"aria-label\":\"Nh\\u1eadp tin nh\\u1eafn\"},value:i||\"\"}),O(v,{className:n.divider,orientation:\"vertical\"}),O(g.a,{onClick:function(){return r.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.a.awrap(u());case 2:return e.abrupt(\"return\",e.sent);case 3:case\"end\":return e.stop()}}))},color:\"primary\",className:n.iconButton},O(y.a,null)))}},\"63Ad\":function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}}},\"8VmE\":function(e,t){function n(){return e.exports=n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},n.apply(this,arguments)}e.exports=n},R82R:function(e,t,n){\"use strict\";var a=n(\"Fcif\"),r=n(\"Ns/9\"),o=n(\"qSp0\");t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(r.a)(e,Object(a.a)({defaultTheme:o.a},t))}},RGu7:function(e,t,n){\"use strict\";n.r(t);var a=n(\"UrUy\"),r=n.n(a),o=n(\"mXGw\"),i=n.n(o),s=n(\"R82R\"),c=n(\"5UIW\"),l=n(\"bJWG\"),d=n(\"SMlj\"),u=n(\"2W1i\"),m=n.n(u),p=n(\"V2/N\"),b=n(\"f+cz\"),f=n(\"Fcif\"),v=n(\"dV/x\"),g=(n(\"W0B4\"),n(\"PDtE\")),h=n(\"gbh0\"),y=n(\"x+AB\"),x=n(\"2Nex\"),O=n(\"q3GK\"),j=n(\"nnXQ\"),w=n(\"xARA\"),C=\"undefined\"===typeof window?o.useEffect:o.useLayoutEffect,N=o.forwardRef((function(e,t){var n=e.alignItems,a=void 0===n?\"center\":n,r=e.autoFocus,i=void 0!==r&&r,s=e.button,c=void 0!==s&&s,l=e.children,d=e.classes,u=e.className,m=e.component,p=e.ContainerComponent,b=void 0===p?\"li\":p,h=e.ContainerProps,N=(h=void 0===h?{}:h).className,k=Object(v.a)(h,[\"className\"]),E=e.dense,R=void 0!==E&&E,S=e.disabled,I=void 0!==S&&S,B=e.disableGutters,M=void 0!==B&&B,P=e.divider,A=void 0!==P&&P,$=e.focusVisibleClassName,W=e.selected,q=void 0!==W&&W,G=Object(v.a)(e,[\"alignItems\",\"autoFocus\",\"button\",\"children\",\"classes\",\"className\",\"component\",\"ContainerComponent\",\"ContainerProps\",\"dense\",\"disabled\",\"disableGutters\",\"divider\",\"focusVisibleClassName\",\"selected\"]),T=o.useContext(j.a),V={dense:R||T.dense||!1,alignItems:a},_=o.useRef(null);C((function(){i&&_.current&&_.current.focus()}),[i]);var z=o.Children.toArray(l),U=z.length&&Object(x.a)(z[z.length-1],[\"ListItemSecondaryAction\"]),X=o.useCallback((function(e){_.current=w.findDOMNode(e)}),[]),L=Object(O.a)(X,t),F=Object(f.a)({className:Object(g.a)(d.root,u,V.dense&&d.dense,!M&&d.gutters,A&&d.divider,I&&d.disabled,c&&d.button,\"center\"!==a&&d.alignItemsFlexStart,U&&d.secondaryAction,q&&d.selected),disabled:I},G),Q=m||\"li\";return c&&(F.component=m||\"div\",F.focusVisibleClassName=Object(g.a)(d.focusVisible,$),Q=y.a),U?(Q=F.component||m?Q:\"div\",\"li\"===b&&(\"li\"===Q?Q=\"div\":\"li\"===F.component&&(F.component=\"div\")),o.createElement(j.a.Provider,{value:V},o.createElement(b,Object(f.a)({className:Object(g.a)(d.container,N),ref:L},k),o.createElement(Q,F,z),z.pop()))):o.createElement(j.a.Provider,{value:V},o.createElement(Q,Object(f.a)({ref:L},F),z))})),k=Object(h.a)((function(e){return{root:{display:\"flex\",justifyContent:\"flex-start\",alignItems:\"center\",position:\"relative\",textDecoration:\"none\",width:\"100%\",boxSizing:\"border-box\",textAlign:\"left\",paddingTop:8,paddingBottom:8,\"&$focusVisible\":{backgroundColor:e.palette.action.selected},\"&$selected, &$selected:hover\":{backgroundColor:e.palette.action.selected},\"&$disabled\":{opacity:.5}},container:{position:\"relative\"},focusVisible:{},dense:{paddingTop:4,paddingBottom:4},alignItemsFlexStart:{alignItems:\"flex-start\"},disabled:{},divider:{borderBottom:\"1px solid \".concat(e.palette.divider),backgroundClip:\"padding-box\"},gutters:{paddingLeft:16,paddingRight:16},button:{transition:e.transitions.create(\"background-color\",{duration:e.transitions.duration.shortest}),\"&:hover\":{textDecoration:\"none\",backgroundColor:e.palette.action.hover,\"@media (hover: none)\":{backgroundColor:\"transparent\"}}},secondaryAction:{paddingRight:48},selected:{}}}),{name:\"MuiListItem\"})(N),E=n(\"/ZiB\"),R=o.forwardRef((function(e,t){var n=e.children,a=e.classes,r=e.className,i=e.disableTypography,s=void 0!==i&&i,c=e.inset,l=void 0!==c&&c,d=e.primary,u=e.primaryTypographyProps,m=e.secondary,p=e.secondaryTypographyProps,b=Object(v.a)(e,[\"children\",\"classes\",\"className\",\"disableTypography\",\"inset\",\"primary\",\"primaryTypographyProps\",\"secondary\",\"secondaryTypographyProps\"]),h=o.useContext(j.a).dense,y=null!=d?d:n;null==y||y.type===E.a||s||(y=o.createElement(E.a,Object(f.a)({variant:h?\"body2\":\"body1\",className:a.primary,component:\"span\"},u),y));var x=m;return null==x||x.type===E.a||s||(x=o.createElement(E.a,Object(f.a)({variant:\"body2\",className:a.secondary,color:\"textSecondary\"},p),x)),o.createElement(\"div\",Object(f.a)({className:Object(g.a)(a.root,r,h&&a.dense,l&&a.inset,y&&x&&a.multiline),ref:t},b),y,x)})),S=Object(h.a)({root:{flex:\"1 1 auto\",minWidth:0,marginTop:4,marginBottom:4},multiline:{marginTop:6,marginBottom:6},dense:{},inset:{paddingLeft:56},primary:{},secondary:{}},{name:\"MuiListItemText\"})(R),I=n(\"u44p\"),B=n(\"KoC1\"),M=i.a.createElement,P={allConversations:\"query($user: UserWhereInput) {\\n        allConversations(where: { members_some: $user }) {\\n          id\\n          members (where: { isSupporter: null, AND: { isAdmin: null } }) {\\n              id\\n              email\\n          }\\n        }\\n      }\"};function A(e){var t,n=e.user,a=e.onClick,i=Object(o.useState)([]),s=i[0],c=i[1];return Object(o.useEffect)((function(){return t=setInterval((function(){var e,t;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.a.awrap(Object(B.a)({body:{query:P.allConversations,variables:{user:n}}}));case 2:e=a.sent,t=e.data.allConversations,c(t);case 5:case\"end\":return a.stop()}}))}),2020),function(){clearInterval(t)}})),s.length?M(I.a,null,s.map((function(e){return M(k,{button:!0,key:e.id,onClick:function(){return a({id:e.id})}},M(S,{primary:e.members.map((function(e){return e.email})).toString()}))}))):M(\"div\",null,\"...\")}var $=n(\"60we\"),W=[\"video\",\"audio\",\"picture\",\"iframe\",\"img\"],q=o.forwardRef((function(e,t){var n=e.children,a=e.classes,r=e.className,i=e.component,s=void 0===i?\"div\":i,c=e.image,l=e.src,d=e.style,u=Object(v.a)(e,[\"children\",\"classes\",\"className\",\"component\",\"image\",\"src\",\"style\"]),m=-1!==W.indexOf(s),p=!m&&c?Object(f.a)({backgroundImage:'url(\"'.concat(c,'\")')},d):d;return o.createElement(s,Object(f.a)({className:Object(g.a)(a.root,r,m&&a.media,-1!==\"picture img\".indexOf(s)&&a.img),ref:t,style:p,src:m?c||l:void 0},u),n)})),G=Object(h.a)({root:{display:\"block\",backgroundSize:\"cover\",backgroundRepeat:\"no-repeat\",backgroundPosition:\"center\"},media:{width:\"100%\"},img:{objectFit:\"cover\"}},{name:\"MuiCardMedia\"})(q),T=(n(\"bBV7\"),n(\"OrM8\")),V=i.a.createElement,_=Object(s.a)((function(e){return{box:{border:1,background:\"rgba(225, 225, 225, 0.3)\",borderRadius:8,padding:21,height:\"100%\"},paper:{paddingBottom:50},list:{marginBottom:e.spacing(2)},subheader:{backgroundColor:e.palette.background.paper},appBar:{top:\"auto\",bottom:0,backgroundColor:\"white\",boxShadow:\"none\"},toolbar:{padding:13,boder:\"none\"},grow:{flexGrow:1},fabButton:{position:\"absolute\",zIndex:1,top:-30,left:0,right:0,margin:\"0 auto\"}}})),z=\"query {\\n    allAdmins: allUsers(where: { isAdmin: true }) {\\n      id\\n    }\\n  }\",U=\"query($user: UserWhereInput) {\\n    allConversations(where: { members_some: $user }) {\\n      id\\n    }\\n  }\",X='query($conversation: ConversationWhereInput) {\\n    allMessages(orderBy: \"time_ASC\", where: { conversation: $conversation }) {\\n      seller {\\n        isCustomer\\n        isSupporter\\n        isAdmin\\n        email\\n        id\\n      }\\n      id\\n      text\\n      time\\n    }\\n  }',L=\"mutation($members: [UserWhereUniqueInput]) {\\n    createConversation(data: { members: { connect: $members } }) {\\n      id\\n    }\\n  }\";function F(e){e.allConversations,e.allMessages;var t=e.user,n=_(),a=Object(o.useState)(),r=a[0],i=a[1];return V(G,{image:\"/img/tuvilogic_bg.jpg\"},V(c.a,{maxWidth:\"lg\",style:{padding:13,minHeight:\"100vh\"}},V(T.a,{href:\"/\"},\"Quay l\\u1ea1i\"),V(p.a,{container:!0,spacing:1},V(p.a,{item:!0,xs:12,xl:12,sm:12,md:4,lg:6},V(l.a,{className:n.box},V(p.a,{container:!0,spacing:1},V(p.a,{item:!0,xs:12,className:n.scroll},V(b.a,{conversation:r,role:\"isAdmin\"})),V(p.a,{item:!0,xs:12},V($.a,{conversation:r}))))),V(p.a,{item:!0,xs:12,xl:6,sm:6,md:4,lg:3},V(l.a,{className:n.box},V(A,{user:t,onClick:function(e){i(e)}}))),V(p.a,{item:!0,xs:12,xl:6,sm:6,md:4,lg:3},V(l.a,{className:n.box},V(A,{user:t}))))))}F.getInitialProps=function(e){var t,n,a,o,i,s,c,l,d,u,p;return r.a.async((function(b){for(;;)switch(b.prev=b.next){case 0:return t=e.res,n=e.client,a=e.id,e.email,e.isAdmin,e.isSupporter,e.isCustomer,b.prev=1,b.next=4,r.a.awrap(n.request(U,{user:{id:a}}));case 4:if(o=b.sent,!(i=o.allConversations).length){b.next=13;break}return b.next=9,r.a.awrap(n.request(X,{conversation:{id:i[0].id}}));case 9:s=b.sent,c=s.allMessages,b.next=23;break;case 13:return b.next=15,r.a.awrap(n.request(z));case 15:return l=b.sent,(d=l.allAdmins).push({id:a}),b.next=20,r.a.awrap(n.request(L,{members:d}));case 20:u=b.sent,p=u.createConversation,i.push(p);case 23:return b.abrupt(\"return\",{allConversations:i,allMessages:c,user:{id:a}});case 26:b.prev=26,b.t0=b.catch(1),console.log(b.t0),m.a.remove(\"token\"),n.request(\"mutation {\\n      unauthenticateUser {\\n        success\\n      }\\n    }\"),t&&(t.writeHead(302,{Location:\"/login\"}),t.end());case 32:case\"end\":return b.stop()}}),null,null,[[1,26]])};t.default=Object(d.c)(F)},c9Um:function(e,t,n){\"use strict\";var a=n(\"63Ad\");Object.defineProperty(t,\"__esModule\",{value:!0}),t.default=function(e,t){var n=o.default.memo(o.default.forwardRef((function(t,n){return o.default.createElement(i.default,(0,r.default)({ref:n},t),e)})));0;return n.muiName=i.default.muiName,n};var r=a(n(\"8VmE\")),o=a(n(\"mXGw\")),i=a(n(\"iXm2\"))},eiJB:function(e,t,n){\"use strict\";var a=n(\"63Ad\");Object.defineProperty(t,\"__esModule\",{value:!0}),t.default=void 0;var r=a(n(\"mXGw\")),o=(0,a(n(\"c9Um\")).default)(r.default.createElement(\"path\",{d:\"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z\"}),\"Send\");t.default=o},\"f+cz\":function(e,t,n){\"use strict\";n.d(t,\"a\",(function(){return b}));var a=n(\"UrUy\"),r=n.n(a),o=n(\"mXGw\"),i=n.n(o),s=n(\"V2/N\"),c=n(\"bJWG\"),l=n(\"/ZiB\"),d=n(\"BQn0\"),u=n(\"KoC1\"),m=i.a.createElement,p={allMessages:'query($conversation: ConversationWhereInput) {\\n    allMessages(\\n      orderBy: \"time_ASC\", \\n      where: { conversation: $conversation },\\n      first: 100) {\\n      seller {\\n        isCustomer\\n        isSupporter\\n        isAdmin\\n        email\\n        id\\n      }\\n      id\\n      text\\n      time\\n    }\\n  }'};function b(e){var t,n=e.conversation,a=e.role,i=Object(o.useState)([]),b=i[0],f=i[1],v=Object(o.useRef)(null);return Object(o.useEffect)((function(){return t=setInterval((function(){var e,t;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!n){a.next=6;break}return a.next=3,r.a.awrap(Object(u.a)({body:{query:p.allMessages,variables:{conversation:n}}}));case 3:e=a.sent,t=e.data.allMessages,f(t);case 6:case\"end\":return a.stop()}}))}),1e3),function(){clearInterval(t)}})),b.length?m(d.a,{style:{overflowY:\"scroll\",padding:8,maxHeight:\"85vh\"}},b.map((function(e){return m(s.a,{key:e.id,container:!0,spacing:1,justify:e.seller[a]?\"flex-end\":\"flex-start\"},m(s.a,{item:!0},m(c.a,{style:{padding:5,borderRadius:8}},m(l.a,null,e.text))))})),m(\"div\",{ref:v})):m(\"div\",{ref:v},\"\\u0110ang t\\u1ea3i...\")}},iXm2:function(e,t,n){\"use strict\";n.r(t);var a=n(\"VQdz\");n.d(t,\"default\",(function(){return a.a}))},nnXQ:function(e,t,n){\"use strict\";var a=n(\"mXGw\"),r=a.createContext({});t.a=r},oQEK:function(e,t,n){\"use strict\";var a=n(\"Fcif\"),r=n(\"dV/x\"),o=n(\"mXGw\"),i=(n(\"W0B4\"),n(\"PDtE\")),s=n(\"gbh0\"),c=n(\"Rx6o\"),l=n(\"x+AB\"),d=n(\"mxPc\"),u=o.forwardRef((function(e,t){var n=e.edge,s=void 0!==n&&n,c=e.children,u=e.classes,m=e.className,p=e.color,b=void 0===p?\"default\":p,f=e.disabled,v=void 0!==f&&f,g=e.disableFocusRipple,h=void 0!==g&&g,y=e.size,x=void 0===y?\"medium\":y,O=Object(r.a)(e,[\"edge\",\"children\",\"classes\",\"className\",\"color\",\"disabled\",\"disableFocusRipple\",\"size\"]);return o.createElement(l.a,Object(a.a)({className:Object(i.a)(u.root,m,\"default\"!==b&&u[\"color\".concat(Object(d.a)(b))],v&&u.disabled,\"small\"===x&&u[\"size\".concat(Object(d.a)(x))],{start:u.edgeStart,end:u.edgeEnd}[s]),centerRipple:!0,focusRipple:!h,disabled:v,ref:t},O),o.createElement(\"span\",{className:u.label},c))}));t.a=Object(s.a)((function(e){return{root:{textAlign:\"center\",flex:\"0 0 auto\",fontSize:e.typography.pxToRem(24),padding:12,borderRadius:\"50%\",overflow:\"visible\",color:e.palette.action.active,transition:e.transitions.create(\"background-color\",{duration:e.transitions.duration.shortest}),\"&:hover\":{backgroundColor:Object(c.c)(e.palette.action.active,e.palette.action.hoverOpacity),\"@media (hover: none)\":{backgroundColor:\"transparent\"}},\"&$disabled\":{backgroundColor:\"transparent\",color:e.palette.action.disabled}},edgeStart:{marginLeft:-12,\"$sizeSmall&\":{marginLeft:-3}},edgeEnd:{marginRight:-12,\"$sizeSmall&\":{marginRight:-3}},colorInherit:{color:\"inherit\"},colorPrimary:{color:e.palette.primary.main,\"&:hover\":{backgroundColor:Object(c.c)(e.palette.primary.main,e.palette.action.hoverOpacity),\"@media (hover: none)\":{backgroundColor:\"transparent\"}}},colorSecondary:{color:e.palette.secondary.main,\"&:hover\":{backgroundColor:Object(c.c)(e.palette.secondary.main,e.palette.action.hoverOpacity),\"@media (hover: none)\":{backgroundColor:\"transparent\"}}},disabled:{},sizeSmall:{padding:3,fontSize:e.typography.pxToRem(18)},label:{width:\"100%\",display:\"flex\",alignItems:\"inherit\",justifyContent:\"inherit\"}}}),{name:\"MuiIconButton\"})(u)},u44p:function(e,t,n){\"use strict\";var a=n(\"Fcif\"),r=n(\"dV/x\"),o=n(\"mXGw\"),i=(n(\"W0B4\"),n(\"PDtE\")),s=n(\"gbh0\"),c=n(\"nnXQ\"),l=o.forwardRef((function(e,t){var n=e.children,s=e.classes,l=e.className,d=e.component,u=void 0===d?\"ul\":d,m=e.dense,p=void 0!==m&&m,b=e.disablePadding,f=void 0!==b&&b,v=e.subheader,g=Object(r.a)(e,[\"children\",\"classes\",\"className\",\"component\",\"dense\",\"disablePadding\",\"subheader\"]),h=o.useMemo((function(){return{dense:p}}),[p]);return o.createElement(c.a.Provider,{value:h},o.createElement(u,Object(a.a)({className:Object(i.a)(s.root,l,p&&s.dense,!f&&s.padding,v&&s.subheader),ref:t},g),v,n))}));t.a=Object(s.a)({root:{listStyle:\"none\",margin:0,padding:0,position:\"relative\"},padding:{paddingTop:8,paddingBottom:8},dense:{},subheader:{paddingTop:0}},{name:\"MuiList\"})(l)}},[[\"3pQS\",0,1,2,3,5,4,8,6,7,9,10]]]);"}