{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{\"2Nex\":function(e,n,t){\"use strict\";t.d(n,\"a\",(function(){return r}));var a=t(\"mXGw\");function r(e,n){return a.isValidElement(e)&&-1!==n.indexOf(e.type.muiName)}},\"3pQS\":function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push([\"/adminChat\",function(){return t(\"RGu7\")}])},\"60we\":function(e,n,t){\"use strict\";var a=t(\"UrUy\"),r=t.n(a),i=t(\"mXGw\"),s=t.n(i),o=t(\"R82R\"),c=t(\"bJWG\"),u=t(\"q+kb\"),l=t(\"Fcif\"),d=t(\"dV/x\"),m=(t(\"W0B4\"),t(\"PDtE\")),p=t(\"gbh0\"),f=t(\"Rx6o\"),v=i.forwardRef((function(e,n){var t=e.absolute,a=void 0!==t&&t,r=e.classes,s=e.className,o=e.component,c=void 0===o?\"hr\":o,u=e.flexItem,p=void 0!==u&&u,f=e.light,v=void 0!==f&&f,b=e.orientation,g=void 0===b?\"horizontal\":b,h=e.role,x=void 0===h?\"hr\"!==c?\"separator\":void 0:h,w=e.variant,y=void 0===w?\"fullWidth\":w,j=Object(d.a)(e,[\"absolute\",\"classes\",\"className\",\"component\",\"flexItem\",\"light\",\"orientation\",\"role\",\"variant\"]);return i.createElement(c,Object(l.a)({className:Object(m.a)(r.root,s,\"fullWidth\"!==y&&r[y],a&&r.absolute,p&&r.flexItem,v&&r.light,\"vertical\"===g&&r.vertical),role:x,ref:n},j))})),b=Object(p.a)((function(e){return{root:{height:1,margin:0,border:\"none\",flexShrink:0,backgroundColor:e.palette.divider},absolute:{position:\"absolute\",bottom:0,left:0,width:\"100%\"},inset:{marginLeft:72},light:{backgroundColor:Object(f.c)(e.palette.divider,.08)},middle:{marginLeft:e.spacing(2),marginRight:e.spacing(2)},vertical:{height:\"100%\",width:1},flexItem:{alignSelf:\"stretch\",height:\"auto\"}}}),{name:\"MuiDivider\"})(v),g=t(\"oQEK\"),h=t(\"eiJB\"),x=t.n(h),w=t(\"KoC1\");t.d(n,\"a\",(function(){return C}));var y=s.a.createElement,j={createMessage:\"mutation($text: String, $conversation: ConversationWhereUniqueInput) {\\n    createMessage(\\n      data: { text: $text, conversation: { connect: $conversation } }\\n    ) {\\n      id\\n    }\\n  }\"},O=Object(o.a)((function(e){return{root:{padding:\"1px 2px\",display:\"flex\",alignItems:\"center\",width:\"100%\",borderRadius:8},input:{marginLeft:e.spacing(1),flex:1},iconButton:{padding:8},divider:{height:21,margin:3}}}));function C(e){var n=e.conversation,t=O(),a=Object(i.useState)(),s=a[0],o=a[1],l=Object(i.useState)();l[0],l[1];function d(){var e,t;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!s){a.next=7;break}return a.next=3,r.a.awrap(Object(w.a)({body:{query:j.createMessage,variables:{text:s,conversation:n}}}));case 3:e=a.sent,t=e.data,console.log(t),o(\"\");case 7:case\"end\":return a.stop()}}))}return y(c.a,{className:t.root,onKeyPress:function(e){return r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(\"Enter\"!=e.key){n.next=3;break}return n.next=3,r.a.awrap(d());case 3:case\"end\":return n.stop()}}))}},y(u.a,{className:t.input,placeholder:\"Nh\\u1eadp tin nh\\u1eafn\",onChange:function(e){return o(e.target.value)},inputProps:{\"aria-label\":\"Nh\\u1eadp tin nh\\u1eafn\"},value:s||\"\"}),y(b,{className:t.divider,orientation:\"vertical\"}),y(g.a,{onClick:function(){return r.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.a.awrap(d());case 2:return e.abrupt(\"return\",e.sent);case 3:case\"end\":return e.stop()}}))},color:\"primary\",className:t.iconButton},y(x.a,null)))}},R82R:function(e,n,t){\"use strict\";var a=t(\"Fcif\"),r=t(\"Ns/9\"),i=t(\"qSp0\");n.a=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(r.a)(e,Object(a.a)({defaultTheme:i.a},n))}},RGu7:function(e,n,t){\"use strict\";t.r(n);var a=t(\"UrUy\"),r=t.n(a),i=t(\"mXGw\"),s=t.n(i),o=t(\"R82R\"),c=t(\"5UIW\"),u=t(\"bJWG\"),l=t(\"SMlj\"),d=t(\"2W1i\"),m=t.n(d),p=t(\"V2/N\"),f=t(\"f+cz\"),v=t(\"v6vt\"),b=t(\"5bSt\"),g=t(\"u44p\"),h=t(\"KoC1\"),x=s.a.createElement,w={allConversations:\"query($user: UserWhereInput) {\\n        allConversations(where: { members_some: $user }) {\\n          id\\n          members (where: { isSupporter: null, AND: { isAdmin: null } }) {\\n              id\\n              email\\n          }\\n        }\\n      }\"};function y(e){var n,t=e.user,a=e.onClick,s=Object(i.useState)([]),o=s[0],c=s[1];return Object(i.useEffect)((function(){return n=setInterval((function(){var e,n;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.a.awrap(Object(h.a)({body:{query:w.allConversations,variables:{user:t}}}));case 2:e=a.sent,n=e.data.allConversations,c(n);case 5:case\"end\":return a.stop()}}))}),2020),function(){clearInterval(n)}})),o.length?x(g.a,null,o.map((function(e){return x(v.a,{button:!0,key:e.id,onClick:function(){return a({id:e.id})}},x(b.a,{primary:e.members.map((function(e){return e.email})).toString()}))}))):x(\"div\",null,\"...\")}var j=t(\"60we\"),O=t(\"Fcif\"),C=t(\"dV/x\"),k=(t(\"W0B4\"),t(\"PDtE\")),N=t(\"gbh0\"),S=[\"video\",\"audio\",\"picture\",\"iframe\",\"img\"],M=i.forwardRef((function(e,n){var t=e.children,a=e.classes,r=e.className,s=e.component,o=void 0===s?\"div\":s,c=e.image,u=e.src,l=e.style,d=Object(C.a)(e,[\"children\",\"classes\",\"className\",\"component\",\"image\",\"src\",\"style\"]),m=-1!==S.indexOf(o),p=!m&&c?Object(O.a)({backgroundImage:'url(\"'.concat(c,'\")')},l):l;return i.createElement(o,Object(O.a)({className:Object(k.a)(a.root,r,m&&a.media,-1!==\"picture img\".indexOf(o)&&a.img),ref:n,style:p,src:m?c||u:void 0},d),t)})),E=Object(N.a)({root:{display:\"block\",backgroundSize:\"cover\",backgroundRepeat:\"no-repeat\",backgroundPosition:\"center\"},media:{width:\"100%\"},img:{objectFit:\"cover\"}},{name:\"MuiCardMedia\"})(M),I=(t(\"bBV7\"),t(\"OrM8\")),R=s.a.createElement,q=Object(o.a)((function(e){return{box:{border:1,background:\"rgba(225, 225, 225, 0.3)\",borderRadius:8,padding:21,height:\"100%\"},paper:{paddingBottom:50},list:{marginBottom:e.spacing(2)},subheader:{backgroundColor:e.palette.background.paper},appBar:{top:\"auto\",bottom:0,backgroundColor:\"white\",boxShadow:\"none\"},toolbar:{padding:13,boder:\"none\"},grow:{flexGrow:1},fabButton:{position:\"absolute\",zIndex:1,top:-30,left:0,right:0,margin:\"0 auto\"}}})),B=\"query {\\n    allAdmins: allUsers(where: { isAdmin: true }) {\\n      id\\n    }\\n  }\",W=\"query($user: UserWhereInput) {\\n    allConversations(where: { members_some: $user }) {\\n      id\\n    }\\n  }\",U='query($conversation: ConversationWhereInput) {\\n    allMessages(orderBy: \"time_ASC\", where: { conversation: $conversation }) {\\n      seller {\\n        isCustomer\\n        isSupporter\\n        isAdmin\\n        email\\n        id\\n      }\\n      id\\n      text\\n      time\\n    }\\n  }',$=\"mutation($members: [UserWhereUniqueInput]) {\\n    createConversation(data: { members: { connect: $members } }) {\\n      id\\n    }\\n  }\";function G(e){e.allConversations,e.allMessages;var n=e.user,t=q(),a=Object(i.useState)(),r=a[0],s=a[1];return R(E,{image:\"/img/tuvilogic_bg.jpg\"},R(c.a,{maxWidth:\"lg\",style:{padding:13,minHeight:\"100vh\"}},R(I.a,{href:\"/\"},\"Quay l\\u1ea1i\"),R(p.a,{container:!0,spacing:1},R(p.a,{item:!0,xs:12,xl:12,sm:12,md:4,lg:6},R(u.a,{className:t.box},R(p.a,{container:!0,spacing:1},R(p.a,{item:!0,xs:12,className:t.scroll},R(f.a,{conversation:r,role:\"isAdmin\"})),R(p.a,{item:!0,xs:12},R(j.a,{conversation:r}))))),R(p.a,{item:!0,xs:12,xl:6,sm:6,md:4,lg:3},R(u.a,{className:t.box},R(y,{user:n,onClick:function(e){s(e)}}))),R(p.a,{item:!0,xs:12,xl:6,sm:6,md:4,lg:3},R(u.a,{className:t.box},R(y,{user:n}))))))}G.getInitialProps=function(e){var n,t,a,i,s,o,c,u,l,d,p;return r.a.async((function(f){for(;;)switch(f.prev=f.next){case 0:return n=e.res,t=e.client,a=e.id,e.email,e.isAdmin,e.isSupporter,e.isCustomer,f.prev=1,f.next=4,r.a.awrap(t.request(W,{user:{id:a}}));case 4:if(i=f.sent,!(s=i.allConversations).length){f.next=13;break}return f.next=9,r.a.awrap(t.request(U,{conversation:{id:s[0].id}}));case 9:o=f.sent,c=o.allMessages,f.next=23;break;case 13:return f.next=15,r.a.awrap(t.request(B));case 15:return u=f.sent,(l=u.allAdmins).push({id:a}),f.next=20,r.a.awrap(t.request($,{members:l}));case 20:d=f.sent,p=d.createConversation,s.push(p);case 23:return f.abrupt(\"return\",{allConversations:s,allMessages:c,user:{id:a}});case 26:f.prev=26,f.t0=f.catch(1),console.log(f.t0),m.a.remove(\"token\"),t.request(\"mutation {\\n      unauthenticateUser {\\n        success\\n      }\\n    }\"),n&&(n.writeHead(302,{Location:\"/login\"}),n.end());case 32:case\"end\":return f.stop()}}),null,null,[[1,26]])};n.default=Object(l.c)(G)},eiJB:function(e,n,t){\"use strict\";var a=t(\"63Ad\");Object.defineProperty(n,\"__esModule\",{value:!0}),n.default=void 0;var r=a(t(\"mXGw\")),i=(0,a(t(\"c9Um\")).default)(r.default.createElement(\"path\",{d:\"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z\"}),\"Send\");n.default=i},\"f+cz\":function(e,n,t){\"use strict\";t.d(n,\"a\",(function(){return f}));var a=t(\"UrUy\"),r=t.n(a),i=t(\"mXGw\"),s=t.n(i),o=t(\"V2/N\"),c=t(\"bJWG\"),u=t(\"/ZiB\"),l=t(\"BQn0\"),d=t(\"KoC1\"),m=s.a.createElement,p={allMessages:'query($conversation: ConversationWhereInput) {\\n    allMessages(\\n      orderBy: \"time_ASC\", \\n      where: { conversation: $conversation },\\n      first: 100) {\\n      seller {\\n        isCustomer\\n        isSupporter\\n        isAdmin\\n        email\\n        id\\n      }\\n      id\\n      text\\n      time\\n    }\\n  }'};function f(e){var n,t=e.conversation,a=e.role,s=Object(i.useState)([]),f=s[0],v=s[1],b=Object(i.useRef)(null);return Object(i.useEffect)((function(){return n=setInterval((function(){var e,n;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!t){a.next=6;break}return a.next=3,r.a.awrap(Object(d.a)({body:{query:p.allMessages,variables:{conversation:t}}}));case 3:e=a.sent,n=e.data.allMessages,v(n);case 6:case\"end\":return a.stop()}}))}),1e3),function(){clearInterval(n)}})),f.length?m(l.a,{style:{overflowY:\"scroll\",padding:8,maxHeight:\"85vh\"}},f.map((function(e){return m(o.a,{key:e.id,container:!0,spacing:1,justify:e.seller[a]?\"flex-end\":\"flex-start\"},m(o.a,{item:!0},m(c.a,{style:{padding:5,borderRadius:8}},m(u.a,null,e.text))))})),m(\"div\",{ref:b})):m(\"div\",{ref:b},\"\\u0110ang t\\u1ea3i...\")}},nnXQ:function(e,n,t){\"use strict\";var a=t(\"mXGw\"),r=a.createContext({});n.a=r},u44p:function(e,n,t){\"use strict\";var a=t(\"Fcif\"),r=t(\"dV/x\"),i=t(\"mXGw\"),s=(t(\"W0B4\"),t(\"PDtE\")),o=t(\"gbh0\"),c=t(\"nnXQ\"),u=i.forwardRef((function(e,n){var t=e.children,o=e.classes,u=e.className,l=e.component,d=void 0===l?\"ul\":l,m=e.dense,p=void 0!==m&&m,f=e.disablePadding,v=void 0!==f&&f,b=e.subheader,g=Object(r.a)(e,[\"children\",\"classes\",\"className\",\"component\",\"dense\",\"disablePadding\",\"subheader\"]),h=i.useMemo((function(){return{dense:p}}),[p]);return i.createElement(c.a.Provider,{value:h},i.createElement(d,Object(a.a)({className:Object(s.a)(o.root,u,p&&o.dense,!v&&o.padding,b&&o.subheader),ref:n},g),b,t))}));n.a=Object(o.a)({root:{listStyle:\"none\",margin:0,padding:0,position:\"relative\"},padding:{paddingTop:8,paddingBottom:8},dense:{},subheader:{paddingTop:0}},{name:\"MuiList\"})(u)}},[[\"3pQS\",0,1,3,2,4,5,7,6,8,9,13]]]);"}